package com.zozofood.service;

import java.util.List;

import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageRequest;
import org.springframework.stereotype.Service;

import com.zozofood.builder.RestaurantCreationBuilder;
import com.zozofood.builder.RestaurantResponseBuilder;
import com.zozofood.dao.RestaurantRepository;
import com.zozofood.dto.RestaurantCreationRequestDto;
import com.zozofood.dto.RestaurantCreationResponseDto;
import com.zozofood.dto.RestaurantResponseDTO;
import com.zozofood.exception.RestaurantNotFoundException;
import com.zozofood.model.Restaurant;

@Service
public class RestaurnatServiceImp implements RestaurantService {

	private final RestaurantRepository restaurantRepository;


	public RestaurnatServiceImp(RestaurantRepository restaurantRepository) {
		this.restaurantRepository = restaurantRepository;
	}

	@Override
	public RestaurantCreationResponseDto createRestaurant(RestaurantCreationRequestDto restaurantCreationRequestDto) {
		Restaurant savedRestaurant = restaurantRepository.save(RestaurantCreationBuilder
				.buildRestaurantFromRestaurantCreationRequestDto(restaurantCreationRequestDto));

		return new RestaurantCreationResponseDto(savedRestaurant.getRestaurantId(),
				savedRestaurant.getRestaurantName());
	}

	@Override
	public RestaurantResponseDTO getRestaurantById(Long restaurantId) {

		Restaurant restaurant = restaurantRepository.findById(restaurantId).orElseThrow(
				() -> new RestaurantNotFoundException("Restaurant with id " + restaurantId + " not found"));

		return RestaurantResponseBuilder.restaurantRespFromRestaurant(restaurant);

	}

	@Override
	public Page<RestaurantResponseDTO> searchRestaurantsByName(String keyword, PageRequest pagination) {

		RestaurantResponseDTO restaurantResponseDTO = null;

		if (keyword == null || keyword.isEmpty()) {
			keyword = "";
		}

//		List<Restaurant> searchRestaurantsByKeyword = restaurantRepository.searchRestaurantsByKeyword(keyword,
//				pagination);
//		if (searchRestaurantsByKeyword != null && !searchRestaurantsByKeyword.isEmpty()) {
//
//			for (Restaurant restaurant : searchRestaurantsByKeyword) {
//				RestaurantResponseDTO restaurantResponseDTO = null;
//
//				restaurantResponseDTO = RestaurantResponseBuilder.restaurantRespFromRestaurant(restaurant);
//				restaurantResponseDTOList.add(restaurantResponseDTO);
//
//			}
//		}

		return restaurantResponseDTO;
	}

}
